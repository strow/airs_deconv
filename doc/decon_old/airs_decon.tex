\documentclass[11pt]{article}
\title{AIRS Deconvolution \\ 
  {***} draft {***}}
\author{H.~Motteler, L.~Strow, S.~Hannon}
\date{\today}
\input{crisdefs.tex}
\begin{document}
\maketitle

\section{AIRS spectral response functions}

The \AIRS\ spectral response functions model channel response as 
a function of frequency and associate channels with nominal center
frequencies [1].  Each \AIRS\ channel $i$ has an associated spectral
response function or {\SRF} $\srf_i(v)$ such that the channel
radiance $c_i = \int \srf_i(v)r(v)\,dv$.  The center or peak of this
function is the channel frequency.

Suppose we have $n$ channels and a frequency grid $v$ of $k$ 
points spanning the domains of the functions $\srf_i$.  The grid
step size for our applications is often $0.0025\ \wnum$, the
kcarta resolution [2].  Let $S_k$ be an $n\times k$ array such that
$s_{i,j} = \srf_i(v_j)/w_i$, where $w_i = \sum_j \srf_i(v_j)$, that
is where row $i$ is $\srf_i(v)$ tabulated at the grid $v$ and
normalized so the row sum is 1.  If the channel centers are in
increasing order $S_k$ is banded, and if they are not too close, 
the rows are linearly independent.  $S_k$ is a linear transform
whose domain is radiance at the grid $v$ and whose range is channel
radiances.  If $r$ is radiance at the grid $v$, then $c = S_k r$
gives a good approximation of the channel radiances $c_i =
\int\srf_i(v)r(v)\,dv$.

In practice this is how we convolve kcarta or other simulated
radiances to get {\AIRS} channel radiances, or transmittances 
for our fast transmittance models[3].  We construct $S_k$ either
explicitly or implicitly from {\AIRS} {\SRF} tabulations.  The
matrix $S_k$ in the former case is large but managable with a banded
or sparse representation.

Suppose we have $S_k$ and channel radiances $c$ and want to find
$r$, that is, to deconvolve $c$.  Consider the linear system $S_k x
= c$.  Since $n < k$ for the kcarta grid mentioned above, this is
underdetermined, with infinitely many solutions.  We could add
constraints, take a pseudo-inverse, consider a new matrix $S_b$ with
columns tabulated at some coarser grid, or some combination of the
above.  We begin with two cases, $S_a$ with SRFs tabulated at the
{\AIRS} channel grid, and $S_b$ with SRFs at an intermediate grid,
typically $0.1\ \wnum$, the approximate resolution of the original
measurements.  We then consider the effect of choice of basis set
for the intermdiate representation.

\section{Deconvolution to the AIRS channel grid}

Let $v_a = v_1,v_2,\ldots,v_n$ be channel center frequencies
associated with a set of SRFs.  Similar to $S_k$, let $S_a$ be an
$n\times n$ array where row $i$ is $\srf_i(v)$ tabulated at the $v_a$
grid, with rows normalized to 1.  If the channel centers are in
increasing order $S_a$ is banded, and if they are not too close the
rows are linearly independent.  $S_a$ is a linear transform whose
domain is radiance at the grid $v_a$ and whose range is channel
radiances.  If $r$ is radiance at the grid $v_a$, then $c = S_a r$ is
still an approximation of $\int\srf_i(v)r(v)\,dv$, though not as good
an approximation as for the high-resolution case.

Consider the linear system $S_a x = c$, similar to the case $S_k x =
c$ above, where we are given $S_a$ and channel signals $c$ and want
to find radiances $x$.  Since $S_a$ is an $n \times n$ matrix and
may have linearly independent rows, we might hope to solve for $r$.
However in practice there are problems.  If we take $v_a$ as the
standard AIRS L1b channel set, we find $S_a$ is poorly conditioned,
without a usable inverse.  This is due to the L1b channel spacing,
which because of module overlaps is quite variable, with the closest
channels only $0.0036\ \wnum$ apart.

If we use the the linear function $g(v) = 4\cdot 10^{-4} \cdot v -
0.04$, where $v$ is frequency, as a lower bound on the acceptable
channel spacing, we drop about 64 out of the 2378 L1b channels and
the condition number of $S_a$ is much improved, to around 30.  With
the partly synthetic L1c channel set, $g(v)$ drops only 4 channels
and $\hbox{cond}(S_a)$ is about 250, still low enough for a useful
inverse.

\begin{itemize}
  \item show figures for channel trimming
  \item compare this approach with more recent results
  \item the main point of this section is the channel trimming and
    discussion of condition number---maybe merge with the following
    section into a single discussion where the intermediate grid
    size varies from $n$ to $k$.
\end{itemize}


\section{Deconvolution to the SRF tabulation grid}

We now consider deconvolution to an intermediate grid.  Typically
this will be at $0.1\ \wnum$, the resolution of the tabulated SRFs.
Let $v_b = v_1,v_2,\ldots,v_m$ be channel center frequencies
associated with a set of SRFs.  Similar to $S_k$, let $S_b$ be an
$n\times m$ array where row $i$ is $\srf_i(v)$ tabulated at the
$v_m$ grid, with rows normalized to 1.  If the channel centers are
in increasing order $S_m$ is banded, and if they are not too close
the rows are linearly independent.  $S_m$ is a linear transform
whose domain is radiance at the grid $v_m$ and whose range is
channel radiances.  If $r$ is radiance at the grid $v_b$, then $c =
S_b r$ is a good approximation of $\int\srf_i(v)r(v)\,dv$.

Consider the linear system $S_b x = c$, similar to the case $S_k x =
c$ above, where we are given $S_b$ and channel signals $c$ and want
to find radiances $x$.  Since $n < m < k$, as with $S_k$, the system
will be underdetermined, but more manageable because for the default
resolutions $m$ is approximately 40 times less than $k$, so finding
the pseudo-inverse of $S_b$ becomes tractible.

\begin{itemize}
  \item this works well in practice
  \item show representative results from cris\_test4
  \item there is some redundant detail in the descriptions of
    $S_{a,b,k}$ that will go away if the sections are merged
\end{itemize}

\section{A sinc basis for the intermediate representation}

\section{Applications}

\end{document}

